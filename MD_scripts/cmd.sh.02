#5.x version of gromacs#
#based on gromacs lysozyme tutorial#
#first of all download the needed files and put them into the work file#

stdbuf -o 0 pdb2gmx -f Protein.pdb -o Protein_processed.gro -water spce   <<END
15

END
#stdbuf -o 0 and | ... extra#

editconf -f Protein_processed.gro -o Protein_newbox.gro  -c -d 1.0 -bt cubic

genbox -cp Protein_newbox.gro  -cs spc216.gro -o Protein_solv.gro -p topol.top

grompp -f ions.mdp -c Protein_solv.gro -p topol.top -o ions.tpr

genion -s ions.tpr -o Protein_solv_ions.gro -p topol.top -pname NA -nname CL -nn 6 <<END
13
END

grompp -f minim.mdp -c Protein_solv_ions.gro -p topol.top -o em.tpr

mdrun -v -deffnm em
#Energy minimization not slow#



g_energy -f em.edr -o potential.xvg <<END
10

END

grompp -f nvt.mdp -c em.gro -p topol.top -o nvt.tpr

gmx mdrun -nt 1 -deffnm nvt

g_energy -f nvt.edr <<END
15

END

gmx grompp -f npt.mdp -c nvt.gro -t nvt.cpt -p topol.top -o npt.tpr

gmx mdrun -nt 1 -deffnm npt > npt.out 2> npt.err

# > to send different data generated by the program to two separated files#ui 


gmx energy -f npt.edr -o pressure.xvg <<END
16

END

gmx energy -f npt.edr -o density.xvg <<END
22

END



#equilibration#

gmx grompp -f md.mdp -c npt.gro -t npt.cpt -p topol.top -o md_0_1.tpr

gmx mdrun -nt 1 -deffnm md_0_1

# gmx mdrun -deffnm md_0_1 -nb gpu use this command to run it in a GPU#

#molecular dynamic#



gmx trjconv -s md_0_1.tpr -f md_0_1.xtc -o md_0_1_noPBC.xtc -pbc mol -ur compact <<END
0

0

END

#system
gmx trjconv -s md_0_1.tpr -f md_0_1.xtc -o md_0_1_noPBC.xtc -pbc mol -ur compact <<END
1

1

END

#protein
gmx rms -s md_0_1.tpr -f md_0_1_noPBC.xtc -o rmsd.xvg -tu ns <<END
4

4

END
#backbone

gmx rms -s em.tpr -f md_0_1_noPBC.xtc -o rmsd_xtal.xvg -tu ns <<END
0

0

END
#System

gmx rms -s em.tpr -f md_0_1_noPBC.xtc -o rmsd_xtal.xvg -tu ns <<END
1

1

END
#protein

gmx gyrate -s md_0_1.tpr -f md_0_1_noPBC.xtc -o gyrate.xvg <<END
0

0

END
#system

gmx gyrate -s md_0_1.tpr -f md_0_1_noPBC.xtc -o gyrate.xvg <<END
1

1

END
#protein

#analysis#













